<div class="ui grid grid-no-margin post-summary">

    <div class="sixteen wide tablet four wide computer column column-no-padding post-summary-image">
        <a href="/post/{{ post.slug }}" class="post-summary-image-link" {% if post.feature_image %} style="background-image:url({{ post.feature_image.thumb(400, 400) }})" {% endif %}>  
                    <!-- {% if post.feature_image %}
                          <img class="attachment-medium size-medium wp-post-image" src="{{ post.feature_image.thumb(160, 160) }}" >
                        {% endif %} -->
        </a>
    </div>

    <div class="sixteen wide tablet twelve wide computer column content post-summary-content">
        
        {% if post.categories|length > 0 %}
          <div class="post-summary-categories">
            <div class="ui tiny horizontal left floated category meta labels">
            {% for cat in post.categories %}
                <a class="ui basic label small" href="/posts/category/{{cat.slug}}" style="background-color: {{cat.main_color}};">
                    <i class="small folder icon"></i>
                    {{ cat.name }}
                </a>
            {% endfor %}
            </div>
          </div>
        {% endif %}

        <a class="post-summary-header" href="/post/{{ post.slug }}">
            <h2>{{post.title}}</h2> 
        </a>

        <div class="post-summary-meta"> 
            <time class="date" datetime="">{{post.updated_at|date("F jS Y")}}</time>
            {% if post.MyPoster %}
                <span class="compact item">by
                    {% for permission in post.MyPoster %}

                        {% for poster in permission.poster %}

                            <a class="fn nickname item" href="/{{poster.type}}/{{poster.id}}" rel="author">
                                {{poster.name}}
                            </a>

                        {% endfor %}

                    {% endfor %}
                </span>
            {% endif %}
        </div>

        <div class="">
            <p>
              {{ html_limit(html_strip(post.content), 60, '... ') }}
              <a href="/post/{{post.slug}}" class="pull right">Read more!</a>
            </p>
        </div>

        <!-- <a href="" class="post-summary-view-more">View more</a> -->

            
            <div class="extra" style="margin-top: 15px;"> 
                    
                {% if post.tags %}
                  <div class="ui tiny horizontal right floated tags meta labels">
                      <i class="small tags icon"></i>
                      {% for tag in post.tags %}
                          <a class="ui label">
                              {{ tag.name }}
                          </a>
                      {% endfor %}
                  </div>
                {% endif %}
                {% if enableComment == 'enable' and __SELF__.user.current_program_id != 2 %} 
                <div class="col-sm-12 col-xs-12 no-padding">
                    <div class="btnlike" id="likeresult{{ __SELF__ }}_{{ post.id }}">
                        {% partial __SELF__ ~ '::postlike' post=post %}
                    </div>
                </div>
                {% endif %}
            </div>
            
    </div>

</div>

{% put scripts %}
  <script>
      function handle_{{ post.id }}(el) {
          $(el).request('{{ __SELF__}}::onLikeClick',
              {
                  error: function(jqXHR) {
                      console.log(jqXHR.responseJSON);
                  },
                  update: {'{{__SELF__}}::postlike': '#likeresult{{ __SELF__ }}_{{ post.id }}'}
              }
          );

          $(el).on('ajaxSuccess', function(){
              if ($('#btnlike_{{ __SELF__ }}_{{ post.id }}').html() == 'Liked'){
                  $('#btnlike_{{ __SELF__ }}_{{ post.id }}').html('Like');
                  $('#iconlike_{{ __SELF__ }}_{{ post.id }}').removeClass('outline');
              }else{
                  $('#btnlike_{{ __SELF__ }}_{{ post.id }}').html('Liked');
                  $('#iconlike_{{ __SELF__ }}_{{ post.id }}').addClass('outline');
              }
          });
      }
  </script>
{% endput %}
