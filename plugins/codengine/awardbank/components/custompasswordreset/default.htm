<div class="column six wide form-hero" id="password_reset_box" style="background-color: #ffffff; height: 460px;">
		<div class="header_image">

			<img src="https://app.xtendsystem.com/themes/xtend/assets/images/logo.svg">

		</div>
     	<div class="ui message error hidden">

		</div>
      {% if __SELF__.user %}


      	<h2>Please Set Your Password:</h2>
      	<div class="sent-target">
			<div class="ui form">
				<div class="ui field">
					<label>Password:</label>
					<input type="password" name="password" id="password">
				</div>
				<div class="ui field">
					<label>Confirm Password:</label>
					<input type="password" name="confirmpassword" id="confirmpassword">
				</div>
                <small>Your password must be at least 8 characters</small>
				<a class="ui fluid large teal submit button" id="reset_password">Set Password</a>
			</div>

		</div>
		{% put scripts %}
			<script>

				$('body').on('click', '#reset_password', function(event){

					event.preventDefault();
					var button = $(this);
					button.addClass('oc-loading');
					var valid = false;
					var error = '';

	   				if($('input[name=password]').val().length > 7 && $('input[name=confirmpassword]').val().length > 7){
		   				if($('input[name=password]').val() != $('input[name=confirmpassword]').val()){
							error = 'Your Password and Confirmation must match to proceed.';
		   				} else {
							valid = true;
		   				}
	   				} else {
						error = 'Your Password must be at least 8 characters long.';
	   				}

	   				if(valid == false){

	   					$('.ui.message.error.hidden').html(error);
						$('.ui.message.error.hidden').show();
						button.removeClass('oc-loading');

	   				} else{

						$.request('onChangePassword', {

				        	data: {

				        		'password': $('input[name=password]').val(),

				        	},

			                success: function(response)
			                {

								window.location.replace("/dashboard");

			                },

				            error: function(XMLHttpRequest, textStatus, errorThrown){
								button.removeClass('oc-loading');
								error = 'An Error Has Taken Place.';
			   					$('.ui.message.error.hidden').html(error);
								$('.ui.message.error.hidden').show();
				            },
				        });
	   				}
   				});

			</script>
		{% endput %}

      {% else %}

      	<h2>Please Enter Your Email To Reset Password:</h2>
      	<div id="sent_target">
			<div class="ui form">
				<div class="ui field">
					<label>E-mail:</label>
					<input type="email" name="email" id="email">
				</div>
				<a class="ui fluid large teal submit button" id="reset_link">Send Reset Link</a>
			</div>
		</div>

		{% put scripts %}

			<script>

				$('body').on('click', '#reset_link', function(event){

					event.preventDefault();
					var valid = false;
					var error = 'Empty';
					var button = $(this);
					button.addClass('oc-loading');

	   				if(isValidEmailAddress($('input[name=email]').val()) == true){
						valid = true;
	   				} else {
						error = 'Your Must Enter A Valid Email.';
	   				}

	   				if(valid == false){

	   					$('.ui.message.error.hidden').html(error);
						$('.ui.message.error.hidden').show();
						button.removeClass('oc-loading');
	   				} else{

						$.request('onSendResetEmail', {

				        	data: {

				        		'email': $('input[name=email]').val(),

				        	},

			                success: function(data)
			                {

			                	if(data['reset'] == true){
			                		$('#sent_target').html('<p>Password Reset Email Sent</p>');
			                	} else {
			                		error = 'No User Found Matching That E-mail';
				   					$('.ui.message.error.hidden').html(error);
									$('.ui.message.error.hidden').show();
			                	}
								button.removeClass('oc-loading');
			                },

				            error: function(XMLHttpRequest, textStatus, errorThrown){
								button.removeClass('oc-loading');
								error = 'An Error Has Taken Place.';
			   					$('.ui.message.error.hidden').html(error);
								$('.ui.message.error.hidden').show();
				            },
				        });
	   				}
   				});

				function isValidEmailAddress(emailAddress) {
				    var pattern = /^([a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+(\.[a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)*|"((([ \t]*\r\n)?[ \t]+)?([\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|\\[\x01-\x09\x0b\x0c\x0d-\x7f\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))*(([ \t]*\r\n)?[ \t]+)?")@(([a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.)+([a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.?$/i;
				    return pattern.test(emailAddress);
				}

			</script>

		{% endput %}

      {% endif %}
</div>
